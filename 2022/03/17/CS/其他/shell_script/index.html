<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Shell Tutorial | 你将孤单而度过一生</title><meta name="keywords" content="2022春季,Linux,Shell"><meta name="author" content="zhaochen20"><meta name="copyright" content="zhaochen20"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="The most important criteria must be a clear, readable layout...">
<meta property="og:type" content="article">
<meta property="og:title" content="Shell Tutorial">
<meta property="og:url" content="http://example.com/2022/03/17/CS/%E5%85%B6%E4%BB%96/shell_script/index.html">
<meta property="og:site_name" content="你将孤单而度过一生">
<meta property="og:description" content="The most important criteria must be a clear, readable layout...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic.imgdb.cn/item/61eccc4f2ab3f51d91d6fcba.jpg">
<meta property="article:published_time" content="2022-03-17T01:00:37.686Z">
<meta property="article:modified_time" content="2022-03-18T21:11:39.685Z">
<meta property="article:author" content="zhaochen20">
<meta property="article:tag" content="2022春季">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Shell">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic.imgdb.cn/item/61eccc4f2ab3f51d91d6fcba.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/2022/03/17/CS/%E5%85%B6%E4%BB%96/shell_script/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"麻了，找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Shell Tutorial',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-19 05:11:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}</style></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend.jpg'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">131</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://pic.imgdb.cn/item/61eccc4f2ab3f51d91d6fcba.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">你将孤单而度过一生</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Shell Tutorial</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-17T01:00:37.686Z" title="发表于 2022-03-17 09:00:37">2022-03-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-18T21:11:39.685Z" title="更新于 2022-03-19 05:11:39">2022-03-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CS/">CS</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>42分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Shell Tutorial"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="philosophy">Philosophy</h1>
<p>There are a number of factors which can go into good, clean, quick, shell scripts.</p>
<ul>
<li>The most important criteria must be a clear, readable layout.</li>
<li>Second is avoiding unnecessary commands.</li>
</ul>
<h2 id="a-clear-layout"><strong>A clear layout</strong></h2>
<p><strong>A clear layout</strong> makes the difference between a shell script appearing as "black magic" and one which is easily maintained and understood. You may be forgiven for thinking that with a simple script, this is not too significant a problem, but two things here are worth bearing in mind.</p>
<ol type="1">
<li>First, a simple script will, more often than anticipated, grow into a large, complex one.</li>
<li>Secondly, if nobody else can understand how it works, you will be lumbered with maintaining it yourself for the rest of your life!</li>
</ol>
<p>Something about shell scripts seems to make them particularly likely to be badly indented, and since the main control structures are if/then/else and loops, indentation is critical for understanding what a script does.</p>
<h2 id="avoiding-unnecessary-commands">avoiding unnecessary commands</h2>
<p>One weakness in many shell scripts is lines such as:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat /tmp/myfile | grep <span class="string">&quot;mystring&quot;</span></span><br></pre></td></tr></table></figure>
<p>which would run much faster as:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">grep <span class="string">&quot;mystring&quot;</span> /tmp/myfile</span><br></pre></td></tr></table></figure>
<p>Not much, you may consider; the OS has to load up the <code>/bin/grep</code> executable, which is a reasonably small 75600 bytes on my system, open a <code>pipe</code> in memory for the transfer, load and run the <code>/bin/cat</code> executable, which is an even smaller 9528 bytes on my system, attach it to the input of the pipe, and let it run.</p>
<p>Of course, this kind of thing is what the OS is there for, and it's normally pretty efficient at doing it. But if this command were in a loop being run many times over, the saving of not locating and loading the <code>cat</code> executable, setting up and releasing the pipe, can make some difference, especially in, say, a CGI environment where there are enough other factors to slow things down without the script itself being too much of a hurdle.</p>
<p>Some Unices are more efficient than others at what they call "building up and tearing down processes" - i.e., loading them up, executing them, and clearing them away again. But however good your flavour of Unix is at doing this, it'd rather not have to do it at all.</p>
<p>Which leads me nicely on to something else: Don't <em>ever</em> feel too close to your own shell scripts; by their nature, the source cannot be closed. If you supply a customer with a shell script, s/he can inspect it quite easily. So you might as well accept that it will be inspected by anyone you pass it to; use this to your advantage with the <a target="_blank" rel="noopener" href="http://www.gnu.org/copyleft/gpl.html">GPL</a> - encourage people to give you feedback and bugfixes for free!</p>
<h1 id="a-first-script">A First Script</h1>
<p><a target="_blank" rel="noopener" href="https://www.shellscript.sh/eg/first.sh.txt">first.sh</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># This is a comment!</span></span><br><span class="line"><span class="built_in">echo</span> Hello World        <span class="comment"># This is a comment, too!</span></span><br></pre></td></tr></table></figure>
<p>The first line tells Unix that the file is to be executed by /bin/sh. This is the standard location of the Bourne shell on just about every Unix system. If you're using GNU/Linux, /bin/sh is normally a symbolic link to bash (or, more recently, dash).</p>
<p>The second line begins with a special symbol: <code>#</code>. This marks the line as a comment, and it is ignored completely by the shell.</p>
<p>The only exception is when the <em>very first</em> line of the file starts with <code>#!</code> - as ours does.</p>
<p>This is a special directive which Unix treats specially. It means that even if you are using csh, ksh, or anything else as your interactive shell, that what follows should be interpreted by the Bourne shell.</p>
<p>Similarly, a Perl script may start with the line <code>#!/usr/bin/perl</code>to tell your interactive shell that the program which follows should be executed by perl. For Bourne shell programming, we shall stick to `#!/bin/sh.</p>
<p>The third line runs a command: echo, with two parameters, or arguments - the first is "Hello"; the second is "World".</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; <span class="built_in">echo</span> hello world</span><br><span class="line">hello world</span><br><span class="line">&gt; <span class="built_in">echo</span> hello world zhaochen20</span><br><span class="line">hello world zhaochen20</span><br></pre></td></tr></table></figure>
<p>Note that echo will automatically put a single space between its parameters. The # symbol still marks a comment; the # and anything following it is ignored by the shell.</p>
<p>now run <code>chmod 755 first.sh</code> to make the text file executable, and run <code>./first.sh</code>. Your screen should then look like this:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ chmod 755 first.sh</span><br><span class="line">$ ./first.sh</span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure>
<p>Now let's make a few changes.</p>
<p>First, note that <code>echo</code> puts ONE space between its parameters. Put a few spaces between "Hello" and "World". What do you expect the output to be? What about putting a TAB character between them?</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; <span class="built_in">echo</span> hello       world zhaochen20</span><br><span class="line">hello world zhaochen20</span><br></pre></td></tr></table></figure>
<p>As always with shell programming, try it and see.</p>
<p>The output is exactly the same! We are calling the <code>echo</code> program with two arguments; it doesn't care any more than <code>cp</code> does about the gaps in between them. Now modify the code again:</p>
<p>This time it works. You probably expected that, too, if you have experience of other programming languages. But the key to understanding what is going on with more complex command and shell script, is to understand and be able to explain: WHY?</p>
<p><code>echo</code> has now been called with just ONE argument - the string "Hello World". It prints this out exactly.</p>
<p>The point to understand here is that the shell parses the arguments BEFORE passing them on to the program being called. In this case, it strips the quotes but passes the string as one argument.</p>
<p>As a final example, type in the following script. Try to predict the outcome before you run it:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">``` first2.sh</span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line"><span class="comment"># This is a comment!</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello      World&quot;</span>       <span class="comment"># This is a comment, too!</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello * World&quot;</span></span><br><span class="line"><span class="built_in">echo</span> Hello * World</span><br><span class="line"><span class="built_in">echo</span> Hello      World</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello&quot;</span> World</span><br><span class="line"><span class="built_in">echo</span> Hello <span class="string">&quot;     &quot;</span> World</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello &quot;</span>*<span class="string">&quot; World&quot;</span></span><br><span class="line"><span class="built_in">echo</span> `hello` world</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;hello&#x27;</span> world</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; ./first.sh</span><br><span class="line">Hello      World</span><br><span class="line">Hello World</span><br><span class="line">Hello * World</span><br><span class="line">Hello first.sh World</span><br><span class="line">Hello World</span><br><span class="line">Hello World</span><br><span class="line">Hello       World</span><br><span class="line">Hello * World</span><br><span class="line">./first.sh: line 11: hello: <span class="built_in">command</span> not found</span><br><span class="line">world</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>
<p>Damn, I also don’t know.</p>
<p>Is everything as you expected? If not, don't worry! These are just some of the things we will be covering in this tutorial ... and yes, we will be using more powerful commands than <code>echo</code>!</p>
<h1 id="variables---part-i">Variables - Part I</h1>
<p>Just about every programming language in existence has the concept of <em>variables</em> - a symbolic name for a chunk of memory to which we can assign values, read and manipulate its contents.</p>
<p>The Bourne shell is no exception, and this section introduces that idea. This is taken further in <a target="_blank" rel="noopener" href="https://www.shellscript.sh/variables2.html">Variables - Part II</a> which looks into variables which are set for us by the environment.</p>
<p>Let's look back at our first Hello World example. This could be done using variables (though it's such a simple example that it doesn't really warrant it!)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">``` var.sh</span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line">MY_MESSAGE=<span class="string">&quot;Hello World&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$MY_MESSAGE</span></span><br></pre></td></tr></table></figure>
<p>Note that there must be no spaces around the "=" sign: <code>VAR=value</code> works; <code>VAR = value</code> doesn't work. In the first case, the shell sees the "=" symbol and treats the command as a variable assignment. In the second case, the shell assumes that VAR must be the name of a command and tries to execute it.</p>
<p>This assigns the string "Hello World" to the variable <code>MY_MESSAGE</code> then <code>echo</code>es out the value of the variable.</p>
<p>Note that we need the quotes around the string Hello World. Whereas we could get away with <code>echo Hello World</code> because echo will take any number of parameters, a variable can only hold one value, so a string with spaces must be quoted so that the shell knows to treat it all as one. Otherwise, the shell will try to execute the command <code>World</code> after assigning <code>MY_MESSAGE=Hello</code></p>
<p>The shell does not care about types of variables; they may store strings, integers, real numbers - anything you like.</p>
<p>People used to Perl may be quite happy with this; if you've grown up with C, Pascal, or worse yet Ada, this may seem quite strange.</p>
<p>In truth, these are all stored as strings, but routines which expect a number can treat them as such.</p>
<p>If you assign a string to a variable then try to add 1 to it, you will not get away with it:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ x=<span class="string">&quot;hello&quot;</span></span><br><span class="line">$ expr <span class="variable">$x</span> + 1</span><br><span class="line">expr: non-numeric argument</span><br><span class="line"></span><br><span class="line">&gt; <span class="variable">$x</span> + 1</span><br><span class="line">The program <span class="string">&#x27;hello&#x27;</span> can be found <span class="keyword">in</span> the following formulae:</span><br><span class="line">  * hello</span><br><span class="line">  * perkeep</span><br><span class="line">Try: brew install &lt;selected formula&gt;</span><br><span class="line"></span><br><span class="line">&gt; x=<span class="string">&quot;echo&quot;</span></span><br><span class="line">&gt; <span class="variable">$x</span> 1</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>This is because the external program <code>expr</code> only expects numbers. But there is no syntactic difference between:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">MY_MESSAGE=<span class="string">&quot;Hello World&quot;</span></span><br><span class="line">MY_SHORT_MESSAGE=hi</span><br><span class="line">MY_NUMBER=1</span><br><span class="line">MY_PI=3.142</span><br><span class="line">MY_OTHER_PI=<span class="string">&quot;3.142&quot;</span></span><br><span class="line">MY_MIXED=123abc</span><br></pre></td></tr></table></figure>
<p>Note though that special characters must be properly escaped to avoid interpretation by the shell.</p>
<p>This is discussed further in Chapter 6, <a target="_blank" rel="noopener" href="https://www.shellscript.sh/escape.html">Escape Characters</a>.</p>
<p>We can interactively set variable names using the <code>read</code> command; the following script asks you for your name then greets you personally:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">```var2.sh</span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line"><span class="built_in">echo</span> What is your name?</span><br><span class="line"><span class="built_in">read</span> MY_NAME</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello <span class="variable">$MY_NAME</span> - hope you&#x27;re well.&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">&gt; ./first.sh</span><br><span class="line">What is your name?</span><br><span class="line">zhaochen20</span><br><span class="line">Hello zhaochen20 - hope you<span class="string">&#x27;re well.</span></span><br></pre></td></tr></table></figure>
<p>Mario Bacinsky kindly pointed out to me that I had originally missed out the double-quotes in line 3, which meant that the single-quote in the word "you're" was unmatched, causing an error. It is this kind of thing which can drive a shell programmer crazy, so watch out for them!</p>
<p>This is using the shell-builtin command <code>read</code> which reads a line from standard input into the variable supplied.</p>
<p>Note that even if you give it your full name and don't use double quotes around the <code>echo</code> command, it still outputs correctly. How is this done? With the <code>MY_MESSAGE</code> variable earlier we had to put double quotes around it to set it.</p>
<p>What happens, is that the <code>read</code> command automatically places quotes around its input, so that spaces are treated correctly. (You will need to quote the output, of course - e.g. <code>echo "$MY_MESSAGE"</code>).</p>
<h2 id="scope-of-variables">Scope of Variables</h2>
<p>Variables in the Bourne shell do not have to be declared, as they do in languages like C. But if you try to read an undeclared variable, the result is the empty string. You get no warnings or errors. This can cause some subtle bugs - if you assign <code>MY_OBFUSCATED_VARIABLE=Hello</code> and then <code>echo $MY_OSFUCATED_VARIABLE</code> Then you will get nothing (as the second OBFUSCATED is mis-spelled).</p>
<p>There is a command called <code>export</code> which has a fundamental effect on the scope of variables. In order to really know what's going on with your variables, you will need to understand something about how this is used.</p>
<p>Create a small shell script, <code>myvar2.sh</code>:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;MYVAR is: <span class="variable">$MYVAR</span>&quot;</span></span><br><span class="line">MYVAR=<span class="string">&quot;hi there&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;MYVAR is: <span class="variable">$MYVAR</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>Now run the script:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ ./myvar2.sh</span><br><span class="line">MYVAR is:</span><br><span class="line">MYVAR is: hi there</span><br></pre></td></tr></table></figure>
<p>MYVAR hasn't been set to any value, so it's blank. Then we give it a value, and it has the expected result.</p>
<p>Now run:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ MYVAR=hello</span><br><span class="line">$ ./myvar2.sh</span><br><span class="line">MYVAR is:</span><br><span class="line">MYVAR is: hi there</span><br></pre></td></tr></table></figure>
<p>It's still not been set! What's going on?!</p>
<p>When you call <code>myvar2.sh</code> from your interactive shell, a new shell is spawned to run the script. This is partly because of the <code>#!/bin/sh</code> line at the start of the script, which we discussed <a target="_blank" rel="noopener" href="https://www.shellscript.sh/first.html">earlier</a>.</p>
<p>We need to <code>export</code> the variable for it to be inherited by another program - including a shell script. Type:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">export</span> MYVAR</span><br><span class="line">$ ./myvar2.sh</span><br><span class="line">MYVAR is: hello</span><br><span class="line">MYVAR is: hi there</span><br></pre></td></tr></table></figure>
<p>Now look at line 3 of the script: this is changing the value of <code>MYVAR</code>. But there is no way that this will be passed back to your interactive shell. Try reading the value of <code>MYVAR</code>:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$MYVAR</span></span><br><span class="line">hello</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>Once the shell script exits, its environment is destroyed. But <code>MYVAR</code> keeps its value of <code>hello</code> within your interactive shell.</p>
<p>In order to receive environment changes back from the script, we must <em>source</em> the script - this effectively runs the script within our own interactive shell, instead of spawning another shell to run it.</p>
<p>We can source a script via the "." (dot) command:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ MYVAR=hello</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$MYVAR</span></span><br><span class="line">hello</span><br><span class="line">$ . ./myvar2.sh</span><br><span class="line">MYVAR is: hello</span><br><span class="line">MYVAR is: hi there</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$MYVAR</span></span><br><span class="line">hi there</span><br></pre></td></tr></table></figure>
<p>The change has now made it out into our shell again! This is how your <code>.profile</code> or <code>.bash_profile</code> file works, for example.</p>
<p>Note that in this case, we don't need to <code>export MYVAR</code>.</p>
<p>Thanks to <em>sway</em> for pointing out that I'd originally said <code>echo MYVAR</code> above, not <code>echo $MYVAR</code> as it should be. Another example of an easy mistake to make with shell scripts. One other thing worth mentioning at this point about variables is to consider the following shell script:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; . ./first.sh</span><br><span class="line">MYVAR is:</span><br><span class="line">MYVAR is: hi there</span><br><span class="line">&gt; MYVAR=1</span><br><span class="line">&gt; . ./first.sh</span><br><span class="line">MYVAR is: 1</span><br><span class="line">MYVAR is: hi there</span><br><span class="line">&gt; echo &quot;$MYVAR&quot;</span><br><span class="line">hi there</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">&gt; ./first.sh</span><br><span class="line">MYVAR is:</span><br><span class="line">MYVAR is: hi there</span><br><span class="line">&gt; MYVAR=1</span><br><span class="line">&gt; ./first.sh</span><br><span class="line">MYVAR is:</span><br><span class="line">MYVAR is: hi there</span><br><span class="line">&gt; <span class="built_in">export</span> MYVAR</span><br><span class="line">&gt; ./first.sh</span><br><span class="line">MYVAR is: 1</span><br><span class="line">MYVAR is: hi there</span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$MYVAR</span>&quot;</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>Yeah, we can find that the tiny difference between <code>export var</code> and "." (dot) command.</p>
<p>This is how your <code>.profile</code> or <code>.bash_profile</code> file works, for example. Note that in this case, we don't need to <code>export MYVAR</code>.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;What is your name?&quot;</span></span><br><span class="line"><span class="built_in">read</span> USER_NAME</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello <span class="variable">$USER_NAME</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;I will create you a file called <span class="variable">$&#123;USER_NAME&#125;</span>_file&quot;</span></span><br><span class="line">touch <span class="string">&quot;<span class="variable">$&#123;USER_NAME&#125;</span>_file&quot;</span></span><br></pre></td></tr></table></figure>
<p>So much like f-string in Python.</p>
<p>The shell now knows that we are referring to the variable <code>USER_NAME</code> and that we want it suffixed with "<code>_file</code>". This can be the downfall of many a new shell script programmer, as the source of the problem can be difficult to track down.</p>
<p>Also, note the quotes around <code>"$&#123;USER_NAME&#125;_file"</code> - if the user entered "Steve Parker" (note the space) then without the quotes, the arguments passed to <code>touch</code> would be <code>Steve</code> and <code>Parker_file</code> - that is, we'd effectively be saying <code>touch Steve Parker_file</code>, which is two files to be <code>touch</code>ed, not one. The quotes avoid this. Thanks to Chris for highlighting this.</p>
<h1 id="wildcards">Wildcards</h1>
<p>Wildcards are really nothing new if you have used Unix at all before.</p>
<p>It is not necessarily obvious how they are useful in shell scripts though. This section is really just to get the old grey cells thinking how things look when you're in a shell script - predicting what the effect of using different syntaxes are. This will be used later on, particularly in the <a target="_blank" rel="noopener" href="https://www.shellscript.sh/loops.html">Loops</a> section.</p>
<p>Think first how you would copy all the files from <code>/tmp/a</code> into <code>/tmp/b</code>. All the .txt files? All the .html files? Hopefully you will have come up with:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ cp /tmp/a/* /tmp/b/</span><br><span class="line">$ cp /tmp/a/*.txt /tmp/b/</span><br><span class="line">$ cp /tmp/a/*.html /tmp/b/</span><br></pre></td></tr></table></figure>
<p>Now how would you list the files in <code>/tmp/a/</code> without using <code>ls /tmp/a/</code>? How about <code>echo /tmp/a/*</code>? What are the two key differences between this and the <code>ls</code> output? How can this be useful? Or a hinderance? How could you rename all .txt files to .bak? Note that</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ mv *.txt *.bak</span><br></pre></td></tr></table></figure>
<p>will not have the desired effect; think about how this gets expanded by the shell before it is passed to <code>mv</code>. Try this using <code>echo</code> instead of <code>mv</code> if this helps.</p>
<p>We will look into this further later on, as it uses a few concepts not yet covered.</p>
<h1 id="escape-characters">Escape Characters</h1>
<p>Certain characters are significant to the shell; we have seen, for example, that the use of double quotes (") characters affect how spaces and TAB characters are treated, for example:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> Hello       World</span><br><span class="line">Hello World</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;Hello       World&quot;</span></span><br><span class="line">Hello     World</span><br></pre></td></tr></table></figure>
<p>So how do we display: <code>Hello  "World"</code> ?</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello   \&quot;World\&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>The first and last " characters wrap the whole lot into one parameter passed to <code>echo</code> so that the spacing between the two words is kept as is. But the code:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello   &quot;</span> World <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>would be interpreted as three parameters:</p>
<ol type="1">
<li>"Hello "</li>
<li>World</li>
<li>""</li>
</ol>
<p>So the output would be</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Hello    World</span><br></pre></td></tr></table></figure>
<p>Note that we lose the quotes entirely. This is because the first and second quotes mark off the Hello and following spaces; the second argument is an unquoted "World" and the third argument is the empty string; "".</p>
<p>Thanks to Patrick for pointing out that this:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;Hello   &quot;</span>World<span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>is actually only one parameter (no spaces between the quoted parameters), and that you can test this by replacing the <code>echo</code> command with (for example) <code>ls</code>.</p>
<p>Most characters (<code>*</code>, <code>'</code>, etc) are not interpreted (ie, they are taken literally) by means of placing them in double quotes (""). They are taken as is and passed on to the command being called. An example using the asterisk (*) goes:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> *</span><br><span class="line">case.shtml escape.shtml first.shtml </span><br><span class="line">functions.shtml hints.shtml index.shtml </span><br><span class="line">ip-primer.txt raid1+0.txt</span><br><span class="line">$ <span class="built_in">echo</span> *txt</span><br><span class="line">ip-primer.txt raid1+0.txt</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">*</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;*txt&quot;</span></span><br><span class="line">*txt</span><br></pre></td></tr></table></figure>
<p>In the first example, * is expanded to mean all files in the current directory.</p>
<p>In the second example, *txt means all files ending in <code>txt</code>.</p>
<p>In the third, we put the * in double quotes, and it is interpreted literally.</p>
<p>In the fourth example, the same applies, but we have appended <code>txt</code> to the string.</p>
<p>However, <code>"</code>, <code>$</code>, ``<code>, and</code>` are still interpreted by the shell, even when they're in double quotes.</p>
<p>The backslash <code>\</code> character is used to mark these special characters so that they are not interpreted by the shell, but passed on to the command being run (for example, <code>echo</code>).</p>
<p>So to output the string: (Assuming that the value of <code>$X</code> is 5):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">A quote is <span class="string">&quot;, backslash is \, backtick is `.</span></span><br><span class="line"><span class="string">A few spaces are    and dollar is $. <span class="variable">$X</span> is 5.</span></span><br></pre></td></tr></table></figure>
<p>we would have to write:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;A quote is \&quot;, backslash is \\, backtick is \`.&quot;</span></span><br><span class="line">A quote is <span class="string">&quot;, backslash is \, backtick is `.</span></span><br><span class="line"><span class="string">$ echo &quot;</span>A few spaces are    and dollar is \$. \<span class="variable">$X</span> is <span class="variable">$&#123;X&#125;</span>.<span class="string">&quot;</span></span><br><span class="line"><span class="string">A few spaces are    and dollar is $. <span class="variable">$X</span> is 5.</span></span><br></pre></td></tr></table></figure>
<p>We have seen why the " is special for preserving spacing. Dollar (<code>$</code>) is special because it marks a variable, so <code>$X</code> is replaced by the shell with the contents of the variable <code>X</code>. Backslash (<code>\</code>) is special because it is itself used to mark other characters off; we need the following options for a complete shell:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;This is \\ a backslash&quot;</span></span><br><span class="line">This is \ a backslash</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;This is \&quot; a quote and this is \\ a backslash&quot;</span></span><br><span class="line">This is <span class="string">&quot; a quote and this is \ a backslash</span></span><br></pre></td></tr></table></figure>
<p>So backslash itself must be escaped to show that it is to be taken literally. The other special character, the backtick, is discussed later in Chapter 12, <a target="_blank" rel="noopener" href="https://www.shellscript.sh/external.html">External Programs</a>.</p>
<h1 id="loops">Loops</h1>
<p>Most languages have the concept of loops: If we want to repeat a task twenty times, we don't want to have to type in the code twenty times, with maybe a slight change each time. As a result, we have <code>for</code> and <code>while</code> loops in the Bourne shell. This is somewhat fewer features than other languages, but nobody claimed that shell programming has the power of C.</p>
<h2 id="for-loops">For Loops</h2>
<p><code>for</code> loops iterate through a set of values until the list is exhausted:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> 1 2 3 4 5</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Looping ... number <span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>Try this code and see what it does. Note that the values can be anything at all:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hello 1 * 2 goodbye </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Looping ... i is set to <span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">&gt; ./first.sh</span><br><span class="line">Looping ... i is <span class="built_in">set</span> to hello</span><br><span class="line">Looping ... i is <span class="built_in">set</span> to 1</span><br><span class="line">Looping ... i is <span class="built_in">set</span> to first.sh</span><br><span class="line">Looping ... i is <span class="built_in">set</span> to zcy.md</span><br><span class="line">Looping ... i is <span class="built_in">set</span> to 2</span><br><span class="line">Looping ... i is <span class="built_in">set</span> to goodbye</span><br></pre></td></tr></table></figure>
<p>This is well worth trying. Make sure that you understand what is happening here. Try it without the <code>*</code> and grasp the idea, then re-read the <a target="_blank" rel="noopener" href="https://www.shellscript.sh/wildcards.html">Wildcards</a> section and try it again with the <code>*</code> in place. Try it also in different directories, and with the <code>*</code> surrounded by double quotes, and try it preceded by a backslash (<code>\*</code>)</p>
<p>In case you don't have access to a shell at the moment (it is very useful to have a shell to hand whilst reading this tutorial), the results of the above two scripts are:</p>
<h2 id="while-loops">While Loops</h2>
<p><code>while</code> loops can be much more fun! (depending on your idea of fun, and how often you get out of the house... )</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">INPUT_STRING=hello</span><br><span class="line"><span class="keyword">while</span> [ <span class="string">&quot;<span class="variable">$INPUT_STRING</span>&quot;</span> != <span class="string">&quot;bye&quot;</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Please type something in (bye to quit)&quot;</span></span><br><span class="line">  <span class="built_in">read</span> INPUT_STRING</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;You typed: <span class="variable">$INPUT_STRING</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>What happens here, is that the echo and read statements will run indefinitely until you type "bye" when prompted.</p>
<p>Review <a target="_blank" rel="noopener" href="https://www.shellscript.sh/variables1.html">Variables - Part I</a> to see why we set <code>INPUT_STRING=hello</code> before testing it. This makes it a repeat loop, not a traditional while loop.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; ./first.sh</span><br><span class="line">Please type something in (bye to quit)</span><br><span class="line">zhaochen20</span><br><span class="line">You typed: zhaochen20</span><br><span class="line">Please type something in (bye to quit)</span><br><span class="line">acy</span><br><span class="line">You typed: acy</span><br><span class="line">Please type something in (bye to quit)</span><br><span class="line">wwqswez</span><br><span class="line">You typed: wwqswez</span><br><span class="line">Please type something in (bye to quit)</span><br><span class="line">bye</span><br><span class="line">You typed: bye</span><br></pre></td></tr></table></figure>
<p>What happens here, is that the echo and read statements will run indefinitely until you type "bye" when prompted.</p>
<p>Review <a target="_blank" rel="noopener" href="https://www.shellscript.sh/variables1.html">Variables - Part I</a> to see why we set <code>INPUT_STRING=hello</code> before testing it. This makes it a repeat loop, not a traditional while loop.</p>
<p>The colon (<code>:</code>) always evaluates to true; whilst using this can be necessary sometimes, it is often preferable to use a real exit condition. Compare quitting the above loop with the one below; see which is the more elegant. Also think of some situations in which each one would be more useful than the other:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Please type something in (^C to quit)&quot;</span></span><br><span class="line">  <span class="built_in">read</span> INPUT_STRING</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;You typed: <span class="variable">$INPUT_STRING</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">&gt; ./first.sh</span><br><span class="line">Please <span class="built_in">type</span> something <span class="keyword">in</span> (^C to quit)</span><br><span class="line">zhaochen20</span><br><span class="line">You typed: zhaochen20</span><br><span class="line">Please <span class="built_in">type</span> something <span class="keyword">in</span> (^C to quit)</span><br><span class="line">^C</span><br></pre></td></tr></table></figure>
<p>Another useful trick is the <code>while read</code> loop. This example uses the <a target="_blank" rel="noopener" href="https://www.shellscript.sh/case.html">case</a> statement, which we'll cover later. It reads from the file <code>myfile.txt</code>, and for each line, tells you what language it thinks is being used.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> input_text</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="keyword">case</span> <span class="variable">$input_text</span> <span class="keyword">in</span></span><br><span class="line">        hello)          <span class="built_in">echo</span> English    ;;</span><br><span class="line">        howdy)          <span class="built_in">echo</span> American   ;;</span><br><span class="line">        gday)           <span class="built_in">echo</span> Australian ;;</span><br><span class="line">        bonjour)        <span class="built_in">echo</span> French     ;;</span><br><span class="line">        <span class="string">&quot;guten tag&quot;</span>)    <span class="built_in">echo</span> German     ;;</span><br><span class="line">        *)              <span class="built_in">echo</span> Unknown Language: <span class="variable">$input_text</span></span><br><span class="line">                ;;</span><br><span class="line">   <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span> &lt; myfile.txt</span><br></pre></td></tr></table></figure>
<p>(note: Each line must end with a LF (newline) - if <code>cat myfile.txt</code> doesn't end with a blank line, that final line will not be processed.)</p>
<p>his reads the file "<code>myfile.txt</code>", one line at a time, into the variable "<code>$input_text</code>". The <a target="_blank" rel="noopener" href="https://www.shellscript.sh/case.html">case</a> statement then checks the value of <code>$input_text</code>. If the word that was read from <code>myfile.txt</code> was "hello" then it <code>echo</code>es the word "English". If it was "gday" then it will <code>echo Australian</code>. If the word (or words) read from a line of <code>myfile.txt</code> don't match any of the provided patterns, then the catch-all "*" default will display the message "Unknown Language: <span class="math inline">\(input_text&quot; - where of course &quot;\)</span>input_text" is the value of the line that it read in from <code>myfile.txt</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">this file is called myfile.txt and we are using it as an example input.</span><br><span class="line">hello</span><br><span class="line">gday</span><br><span class="line">bonjour</span><br><span class="line">hola</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>A handy Bash (but not Bourne Shell) tip I learned recently from the <a target="_blank" rel="noopener" href="http://www.linuxfromscratch.org/">Linux From Scratch</a> project is:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mkdir rc&#123;0,1,2,3,4,5,6,S&#125;.d</span><br></pre></td></tr></table></figure>
<p>instead of the more cumbersome:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> runlevel <span class="keyword">in</span> 0 1 2 3 4 5 6 S</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  mkdir rc<span class="variable">$&#123;runlevel&#125;</span>.d</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>And this can be done recursively, too:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /</span><br><span class="line">$ ls -ld &#123;,usr,usr/<span class="built_in">local</span>&#125;/&#123;bin,sbin,lib&#125;</span><br><span class="line">drwxr-xr-x    2 root     root         4096 Oct 26 01:00 /bin</span><br><span class="line">drwxr-xr-x    6 root     root         4096 Jan 16 17:09 /lib</span><br><span class="line">drwxr-xr-x    2 root     root         4096 Oct 27 00:02 /sbin</span><br><span class="line">drwxr-xr-x    2 root     root        40960 Jan 16 19:35 usr/bin</span><br><span class="line">drwxr-xr-x   83 root     root        49152 Jan 16 17:23 usr/lib</span><br><span class="line">drwxr-xr-x    2 root     root         4096 Jan 16 22:22 usr/<span class="built_in">local</span>/bin</span><br><span class="line">drwxr-xr-x    3 root     root         4096 Jan 16 19:17 usr/<span class="built_in">local</span>/lib</span><br><span class="line">drwxr-xr-x    2 root     root         4096 Dec 28 00:44 usr/<span class="built_in">local</span>/sbin</span><br><span class="line">drwxr-xr-x    2 root     root         8192 Dec 27 02:10 usr/sbin</span><br></pre></td></tr></table></figure>
<h1 id="test">Test</h1>
<p>Test is used by virtually every shell script written. It may not seem that way, because <code>test</code> is not often called directly. <code>test</code> is more frequently called as <code>[</code>. <code>[</code> is a symbolic link to <code>test</code>, just to make shell programs more readable. It is also normally a shell builtin (which means that the shell itself will interpret <code>[</code> as meaning <code>test</code>, even if your Unix environment is set up differently):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">type</span> [</span><br><span class="line">[ is a shell <span class="built_in">builtin</span></span><br><span class="line">$ <span class="built_in">which</span> [</span><br><span class="line">/usr/bin/[</span><br><span class="line">$ ls -l /usr/bin/[</span><br><span class="line">lrwxrwxrwx 1 root root 4 Mar 27 2000 /usr/bin/[ -&gt; <span class="built_in">test</span></span><br><span class="line">$ ls -l /usr/bin/<span class="built_in">test</span></span><br><span class="line">-rwxr-xr-x 1 root root 35368 Mar 27  2000 /usr/bin/<span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>This means that '<code>[</code>' is actually a program, just like <code>ls</code> and other programs, so it must be surrounded by spaces:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [<span class="variable">$foo</span> = <span class="string">&quot;bar&quot;</span> ]</span><br></pre></td></tr></table></figure>
<p>will not work; it is interpreted as <code>if test$foo = "bar" ]</code>, which is a '<code>]</code>' without a beginning '<code>[</code>'. Put spaces around all your operators. I've highlighted the mandatory spaces with the word 'SPACE' - replace 'SPACE' with an actual space; if there isn't a space there, it won't work:</p>
<p>Note: Some shells also accept "<code>==</code>" for string comparison; this is not portable, a single "<code>=</code>" should be used for strings, or "<code>-eq</code>" for integers.</p>
<p>Test is a simple but powerful comparison utility. For full details, run <code>man test</code> on your system, but here are some usages and typical examples.</p>
<p>Test is most often invoked indirectly via the <code>if</code> and <code>while</code> statements. It is also the reason you will come into difficulties if you create a program called <code>test</code> and try to run it, as this shell builtin will be called instead of your program!</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">&gt; foo=1</span><br><span class="line">&gt; <span class="keyword">if</span> [ <span class="variable">$foo</span> = 1 ]</span><br><span class="line"><span class="keyword">then</span> <span class="built_in">echo</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>The syntax for <code>if...then...else...</code> is:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ ... ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="comment"># if-code</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="comment"># else-code</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>Note that <code>fi</code> is <code>if</code> backwards! This is used again later with <a target="_blank" rel="noopener" href="https://www.shellscript.sh/case.html">case</a> and <code>esac</code>. Also, be aware of the syntax - the "<code>if [ ... ]</code>" and the "<code>then</code>" commands must be on different lines. Alternatively, the semicolon "<code>;</code>" can separate them:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ ... ]; <span class="keyword">then</span></span><br><span class="line">  <span class="comment"># do something</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>You can also use the <code>elif</code>, like this:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>  [ something ]; <span class="keyword">then</span></span><br><span class="line"> <span class="built_in">echo</span> <span class="string">&quot;Something&quot;</span></span><br><span class="line"> <span class="keyword">elif</span> [ something_else ]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;Something else&quot;</span></span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;None of the above&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>This will <code>echo "Something"</code> if the <code>[ something ]</code> test succeeds, otherwise it will test <code>[ something_else ]</code>, and <code>echo "Something else"</code> if that succeeds. If all else fails, it will <code>echo "None of the above"</code>.</p>
<p>Try the following code snippet, before running it set the variable X to various values (try -1, 0, 1, hello, bye, etc). You can do this as follows (thanks to Dave for pointing out the need to export the variable, as noted in <a target="_blank" rel="noopener" href="https://www.shellscript.sh/variables1.html">Variables - Part I</a>.):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -lt <span class="string">&quot;0&quot;</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;X is less than zero&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -gt <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;X is more than zero&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">[ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -le <span class="string">&quot;0&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is less than or equal to  zero&quot;</span></span><br><span class="line">[ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -ge <span class="string">&quot;0&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is more than or equal to zero&quot;</span></span><br><span class="line">[ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> = <span class="string">&quot;0&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is the string or number \&quot;0\&quot;&quot;</span></span><br><span class="line">[ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> = <span class="string">&quot;hello&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X matches the string \&quot;hello\&quot;&quot;</span></span><br><span class="line">[ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> != <span class="string">&quot;hello&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is not the string \&quot;hello\&quot;&quot;</span></span><br><span class="line">[ -n <span class="string">&quot;<span class="variable">$X</span>&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is of nonzero length&quot;</span></span><br><span class="line">[ -f <span class="string">&quot;<span class="variable">$X</span>&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is the path of a real file&quot;</span> || \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;No such file: <span class="variable">$X</span>&quot;</span></span><br><span class="line">[ -x <span class="string">&quot;<span class="variable">$X</span>&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is the path of an executable file&quot;</span></span><br><span class="line">[ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -nt <span class="string">&quot;/etc/passwd&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is a file which is newer than /etc/passwd&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ X=5</span><br><span class="line">$ <span class="built_in">export</span> X</span><br><span class="line">$ ./test.sh</span><br><span class="line">  ... output of test.sh ...</span><br><span class="line">$ X=hello</span><br><span class="line">$ ./test.sh</span><br><span class="line">  ... output of test.sh ...</span><br><span class="line">$ X=test.sh</span><br><span class="line">$ ./test.sh</span><br><span class="line">  ... output of test.sh ...</span><br></pre></td></tr></table></figure>
<p>Then try it again, with <code>$X</code> as the name of an existing file, such as <code>/etc/hosts</code>.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">&gt; X=1</span><br><span class="line">&gt; <span class="built_in">export</span> X</span><br><span class="line">&gt; ./first.sh</span><br><span class="line">X is more than zero</span><br><span class="line">X is more than or equal to zero</span><br><span class="line">X is not the string <span class="string">&quot;hello&quot;</span></span><br><span class="line">X is of nonzero length</span><br><span class="line">No such file: 1</span><br><span class="line">&gt; X=/Users/zhaochen20/THU_CST/2022_spring/linux/lab</span><br><span class="line">&gt; <span class="built_in">export</span> X</span><br><span class="line">&gt; ./first.sh</span><br><span class="line">./first.sh: line 2: [: /Users/zhaochen20/THU_CST/2022_spring/linux/lab: <span class="built_in">integer</span> expression expected</span><br><span class="line">./first.sh: line 6: [: /Users/zhaochen20/THU_CST/2022_spring/linux/lab: <span class="built_in">integer</span> expression expected</span><br><span class="line">./first.sh: line 9: [: /Users/zhaochen20/THU_CST/2022_spring/linux/lab: <span class="built_in">integer</span> expression expected</span><br><span class="line">./first.sh: line 11: [: /Users/zhaochen20/THU_CST/2022_spring/linux/lab: <span class="built_in">integer</span> expression expected</span><br><span class="line">X is not the string <span class="string">&quot;hello&quot;</span></span><br><span class="line">X is of nonzero length</span><br><span class="line">No such file: /Users/zhaochen20/THU_CST/2022_spring/linux/lab</span><br><span class="line">X is the path of an executable file</span><br><span class="line">X is a file <span class="built_in">which</span> is newer than /etc/passwd</span><br></pre></td></tr></table></figure>
<p>Note that we can use the semicolon (<code>;</code>) to join two lines together. This is often done to save a bit of space in simple <code>if</code> statements.</p>
<p>The backslash (<code>\</code>) serves a similar, but opposite purpose: it tells the shell that this is not the end of the line, but that the following line should be treated as part of the current line. This is useful for readability. It is customary to indent the following line after a backslash (<code>\</code>) or semicolon (<code>;</code>).</p>
<p>For example, the semicolon (<code>;</code>) is often used like this to join the <code>if</code> and <code>then</code> keywords:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -nt <span class="string">&quot;/etc/passwd&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is a file which is newer than /etc/passwd&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>whilst the backslash (<code>\</code>) is used to split the single-line command across two lines in the shell script file, for readability purposes:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -nt <span class="string">&quot;/etc/passwd&quot;</span> ] &amp;&amp; \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is a file which is newer than /etc/passwd&quot;</span></span><br></pre></td></tr></table></figure>
<p>As we see from these examples, <code>test</code> can perform many tests on numbers, strings, and filenames.</p>
<p>Thanks to Aaron for pointing out that <code>-a</code>, <code>-e</code> (both meaning "file exists"), <code>-S</code> (file is a Socket), <code>-nt</code> (file is newer than), <code>-ot</code> (file is older than), <code>-ef</code> (paths refer to the same file) and <code>-O</code> (file is owned by the user running the test) are not available in the traditional Bourne shell (eg, /bin/sh on Solaris, AIX, HPUX, etc).</p>
<p>There is a simpler way of writing <code>if</code> statements: The <code>&amp;&amp;</code> and <code>||</code> commands give code to run if the result is true, or false, respectively.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">[ <span class="variable">$X</span> -ne 0 ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;X isn&#x27;t zero&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;X is zero&quot;</span></span><br><span class="line">[ -f <span class="variable">$X</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;X is a file&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;X is not a file&quot;</span></span><br><span class="line">[ -n <span class="variable">$X</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;X is of non-zero length&quot;</span> || \</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;X is of zero length&quot;</span></span><br></pre></td></tr></table></figure>
<p>This syntax is possible because there is a file (or shell-builtin) called <code>[</code> which is linked to <code>test</code>. Be careful using this construct, though, as overuse can lead to very hard-to-read code. The <code>if...then...else...</code> structure is much more readable. Use of the <code>[...]</code> construct is recommended for while loops and trivial sanity checks with which you do not want to overly distract the reader.</p>
<p>Note that when you set X to a non-numeric value, the first few comparisons result in the message:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">test.sh: [: <span class="built_in">integer</span> expression expected before -lt</span><br><span class="line">test.sh: [: <span class="built_in">integer</span> expression expected before -gt</span><br><span class="line">test.sh: [: <span class="built_in">integer</span> expression expected before -le</span><br><span class="line">test.sh: [: <span class="built_in">integer</span> expression expected before -ge</span><br></pre></td></tr></table></figure>
<p>This is because the -lt, -gt, -le and -ge comparisons are only designed for integers, and do not work on strings. The string comparisons, such as <code>!=</code> will happily treat "5" as a string, but there is no sensible way of treating "Hello" as an integer, so the integer comparisons complain.</p>
<p>If you want your shell script to behave more gracefully, you will have to check the contents of the variable before you test it - maybe something like this:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> -en <span class="string">&quot;Please guess the magic number: &quot;</span></span><br><span class="line"><span class="built_in">read</span> X</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$X</span> | grep <span class="string">&quot;[^0-9]&quot;</span> &gt; /dev/null 2&gt;&amp;1</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;$?&quot;</span> -eq <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="comment"># If the grep found something other than 0-9</span></span><br><span class="line">  <span class="comment"># then it&#x27;s not an integer.</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Sorry, wanted a number&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="comment"># The grep found only 0-9, so it&#x27;s an integer. </span></span><br><span class="line">  <span class="comment"># We can safely do a test on it.</span></span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -eq <span class="string">&quot;7&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;You entered the magic number!&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>In this way you can <code>echo</code> a more meaningful message to the user, and exit gracefully. The <code>$?</code> variable is explained in <a target="_blank" rel="noopener" href="https://www.shellscript.sh/variables2.html">Variables - Part II</a>, and <code>grep</code> is a complicated beast, so here goes: <code>grep [0-9]</code> finds lines of text which contain digits (0-9) and possibly other characters, so the caret (<code>^</code>) in <code>grep [^0-9]</code> finds only those lines which don't consist only of numbers. We can then take the opposite (by acting on failure, not success). Okay? The <code>&gt;/dev/null 2&gt;&amp;1</code> directs any output or errors to the special "null" device, instead of going to the user's screen. Many thanks to Paul Schermerhorn for correcting me - this page used to claim that <code>grep -v [0-9]</code> would work, but this is clearly far too simplistic.</p>
<p>We can use test in while loops as follows:</p>
<p>We can use test in while loops as follows:</p>
<hr />
<p><a target="_blank" rel="noopener" href="https://www.shellscript.sh/eg/test2.sh.txt">test2.sh</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">X=0</span><br><span class="line"><span class="keyword">while</span> [ -n <span class="string">&quot;<span class="variable">$X</span>&quot;</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Enter some text (RETURN to quit)&quot;</span></span><br><span class="line">  <span class="built_in">read</span> X</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;You said: <span class="variable">$X</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<hr />
<p>This code will keep asking for input until you hit RETURN (X is zero length). Thanks to Justin Heath for pointing out that the script didn't work - I'd missed out the quotes around $X in the <code>while [ -n "$X" ]</code>. Without those quotes, there is nothing to test when $X is empty. Alexander Weber has pointed out that running this script will end untidily:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ ./test2.sh</span><br><span class="line">Enter some text (RETURN to quit)</span><br><span class="line">fred</span><br><span class="line">You said: fred</span><br><span class="line">Enter some text (RETURN to quit)</span><br><span class="line">wilma</span><br><span class="line">You said: wilma</span><br><span class="line">Enter some text (RETURN to quit)</span><br><span class="line"></span><br><span class="line">You said:</span><br><span class="line">$ </span><br></pre></td></tr></table></figure>
<p>This can be tidied up with another test within the loop:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">X=0</span><br><span class="line"><span class="keyword">while</span> [ -n <span class="string">&quot;<span class="variable">$X</span>&quot;</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Enter some text (RETURN to quit)&quot;</span></span><br><span class="line">  <span class="built_in">read</span> X</span><br><span class="line">  <span class="keyword">if</span> [ -n <span class="string">&quot;<span class="variable">$X</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;You said: <span class="variable">$X</span>&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>Note also that I've used two different syntaxes for <code>if</code> statements on this page. These are:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$X</span>&quot;</span> -lt <span class="string">&quot;0&quot;</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;X is less than zero&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">..........  and  ........</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -n <span class="string">&quot;<span class="variable">$X</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;You said: <span class="variable">$X</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>You must have a break between the <code>if</code> statement and the <code>then</code> construct. This can be a semicolon or a newline, it doesn't matter which, but there must be one or the other between the <code>if</code> and the <code>then</code>. It would be nice to just say:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ -n <span class="string">&quot;<span class="variable">$X</span>&quot;</span> ]</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;You said: <span class="variable">$X</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>but the <code>then</code> and <code>fi</code> are absolutely required.</p>
<h1 id="summary-of-special-symbols">Summary of special symbols</h1>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kevingrace/p/5896386.html">See this!</a></p>
<h1 id="case">Case</h1>
<p>The <code>case</code> statement saves going through a whole set of <code>if .. then .. else</code> statements. Its syntax is really quite simple:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Please talk to me ...&quot;</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">read</span> INPUT_STRING</span><br><span class="line">  <span class="keyword">case</span> <span class="variable">$INPUT_STRING</span> <span class="keyword">in</span></span><br><span class="line">	hello)</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;Hello yourself!&quot;</span></span><br><span class="line">		;;</span><br><span class="line">	<span class="built_in">bye</span>)</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;See you again!&quot;</span></span><br><span class="line">		<span class="built_in">break</span></span><br><span class="line">		;;</span><br><span class="line">	*)</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;Sorry, I don&#x27;t understand&quot;</span></span><br><span class="line">		;;</span><br><span class="line">  <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;That&#x27;s all folks!&quot;</span></span><br></pre></td></tr></table></figure>
<p>Okay, so it's not the best conversationalist in the world; it's only an example!</p>
<p>Try running it and check how it works...</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ ./talk.sh</span><br><span class="line">Please talk to me ...</span><br><span class="line">hello</span><br><span class="line">Hello yourself!</span><br><span class="line">What <span class="keyword">do</span> you think of politics?</span><br><span class="line">Sorry, I don<span class="string">&#x27;t understand</span></span><br><span class="line"><span class="string">bye</span></span><br><span class="line"><span class="string">See you again!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">That&#x27;</span>s all folks!</span><br></pre></td></tr></table></figure>
<p>The syntax is quite simple:</p>
<p>The <code>case</code> line itself is always of the same format, and it means that we are testing the value of the variable <code>INPUT_STRING</code>.</p>
<p>The options we understand are then listed and followed by a right bracket, as <code>hello)</code> and <code>bye)</code>.</p>
<p>This means that if <code>INPUT_STRING</code> matches <code>hello</code> then that section of code is executed, up to the double semicolon.</p>
<p>If <code>INPUT_STRING</code> matches <code>bye</code> then the goodbye message is printed and the loop exits. Note that if we wanted to exit the script completely then we would use the command <code>exit</code> instead of <code>break</code>. The third option here, the <code>*)</code>, is the default catch-all condition; it is not required but is often useful for debugging purposes even if we think we know what values the test variable will have.</p>
<p>The whole case statement is ended with <code>esac</code> (case backwards!) then we end the while loop with a <code>done</code>.</p>
<p>That's about as complicated as <code>case</code> conditions get, but they can be a very useful and powerful tool. They are often used to parse the parameters passed to a shell script, amongst other uses.</p>
<h1 id="variables---part-ii">Variables - Part II</h1>
<p>There are a set of variables which are set for you already, and most of these cannot have values assigned to them. These can contain useful information, which can be used by the script to know about the environment in which it is running.</p>
<p>The first set of variables we will look at are <code>$0 .. $9</code> and <code>$#</code>.</p>
<p>The variable <code>$0</code> is the <em>basename</em> of the program as it was called.</p>
<p><code>$1 .. $9</code> are the first 9 additional parameters the script was called with.</p>
<p>The variable <code>$@</code> is all parameters <code>$1 ..</code> whatever. The variable <code>$*</code>, is similar, but does not preserve any whitespace, and quoting, so "File with spaces" becomes "File" "with" "spaces". This is similar to the <code>echo</code> stuff we looked at in <a target="_blank" rel="noopener" href="https://www.shellscript.sh/first.html">A First Script</a>. As a general rule, use <code>$@</code> and avoid <code>$*</code>.</p>
<p><code>$#</code> is the number of parameters the script was called with.</p>
<p>Let's take an example script:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;I was called with <span class="variable">$#</span> parameters&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;My name is <span class="variable">$0</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;My first parameter is <span class="variable">$1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;My second parameter is <span class="variable">$2</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;All parameters are <span class="variable">$@</span>&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ /home/steve/var3.sh</span><br><span class="line">I was called with 0 parameters</span><br><span class="line">My name is /home/steve/var3.sh</span><br><span class="line">My first parameter is</span><br><span class="line">My second parameter is    </span><br><span class="line">All parameters are </span><br><span class="line">$</span><br><span class="line">$ ./var3.sh hello world earth</span><br><span class="line">I was called with 3 parameters</span><br><span class="line">My name is ./var3.sh</span><br><span class="line">My first parameter is hello</span><br><span class="line">My second parameter is world</span><br><span class="line">All parameters are hello world earth</span><br></pre></td></tr></table></figure>
<p>Note that the value of <code>$0</code> changes depending on how the script was called. The external utility <code>basename</code> can help tidy this up:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;My name is `basename <span class="variable">$0</span>`&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>$#</code> and <code>$1 .. $9</code> are set automatically by the shell.</p>
<p>We can take more than 9 parameters by using the <code>shift</code> command; look at the script below:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="keyword">while</span> [ <span class="string">&quot;<span class="variable">$#</span>&quot;</span> -gt <span class="string">&quot;0&quot;</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;\$1 is <span class="variable">$1</span>&quot;</span></span><br><span class="line">  <span class="built_in">shift</span></span><br><span class="line"><span class="keyword">done</span>  </span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">&gt; ./first.sh a b c d f e r t y u i o g gh h s d gh g</span><br><span class="line"><span class="variable">$1</span> is a</span><br><span class="line"><span class="variable">$1</span> is b</span><br><span class="line"><span class="variable">$1</span> is c</span><br><span class="line"><span class="variable">$1</span> is d</span><br><span class="line"><span class="variable">$1</span> is f</span><br><span class="line"><span class="variable">$1</span> is e</span><br><span class="line"><span class="variable">$1</span> is r</span><br><span class="line"><span class="variable">$1</span> is t</span><br><span class="line"><span class="variable">$1</span> is y</span><br><span class="line"><span class="variable">$1</span> is u</span><br><span class="line"><span class="variable">$1</span> is i</span><br><span class="line"><span class="variable">$1</span> is o</span><br><span class="line"><span class="variable">$1</span> is g</span><br><span class="line"><span class="variable">$1</span> is gh</span><br><span class="line"><span class="variable">$1</span> is h</span><br><span class="line"><span class="variable">$1</span> is s</span><br><span class="line"><span class="variable">$1</span> is d</span><br><span class="line"><span class="variable">$1</span> is gh</span><br><span class="line"><span class="variable">$1</span> is g</span><br></pre></td></tr></table></figure>
<p>This script keeps on using <code>shift</code> until <code>$#</code> is down to zero, at which point the list is empty.</p>
<p>Another special variable is <code>$?</code>. This contains the exit value of the last run command. So the code:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">/usr/<span class="built_in">local</span>/bin/my-command</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;$?&quot;</span> -ne <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Sorry, we had a problem there!&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">zhaochen20</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/03/17/CS/%E5%85%B6%E4%BB%96/shell_script/">http://example.com/2022/03/17/CS/%E5%85%B6%E4%BB%96/shell_script/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">你将孤单而度过一生</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/2022%E6%98%A5%E5%AD%A3/">2022春季</a><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/Shell/">Shell</a></div><div class="post_share"><div class="social-share" data-image="https://pic.imgdb.cn/item/61eccc4f2ab3f51d91d6fcba.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/03/19/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%AF%8F%E6%AC%A1%E8%B5%B7%E9%A3%9E%E9%83%BD%E6%98%AF%E6%B0%B8%E5%88%AB/"><img class="prev-cover" src="https://pic.imgdb.cn/item/61ed14292ab3f51d911d280f.jpg" onerror="onerror=null;src='https://wkphoto.cdn.bcebos.com/1f178a82b9014a9058a735deb9773912b31bee3c.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">每次起飞都是永别</div></div></a></div><div class="next-post pull-right"><a href="/2022/03/17/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%B8%85%E6%99%A8%E4%B8%80%E5%B0%8F%E6%97%B6%EF%BC%8C%E7%B4%AB%E4%B9%9D%E7%81%AB%E7%81%BE%E7%BA%AA%E5%AE%9E/"><img class="next-cover" src="https://pic.imgdb.cn/item/61ed143f2ab3f51d911d4294.jpg" onerror="onerror=null;src='https://wkphoto.cdn.bcebos.com/1f178a82b9014a9058a735deb9773912b31bee3c.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">清晨一小时：紫荆公寓火情纪实</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/02/20/%E9%9A%8F%E7%AC%94/%E6%B8%85%E5%8D%8E%E5%9B%AD%E6%97%A5%E8%AE%B0/%E6%B8%85%E5%8D%8E%E5%9B%AD%E6%97%A5%E8%AE%B0--%E7%AC%AC%E4%BA%8C%E9%83%A8/" title="清华园日记——第二部"><img class="cover" src="https://pic.imgdb.cn/item/620540f92ab3f51d91b65009.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-20</div><div class="title">清华园日记——第二部</div></div></a></div><div><a href="/2022/03/19/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/Euphoria/" title="亢奋 Euphoria丨青春疼痛，永远正在进行时"><img class="cover" src="https://pic.imgdb.cn/item/6234f8855baa1a80ab09d3b9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-19</div><div class="title">亢奋 Euphoria丨青春疼痛，永远正在进行时</div></div></a></div><div><a href="/2022/03/19/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%AF%8F%E6%AC%A1%E8%B5%B7%E9%A3%9E%E9%83%BD%E6%98%AF%E6%B0%B8%E5%88%AB/" title="每次起飞都是永别"><img class="cover" src="https://pic.imgdb.cn/item/61ed14292ab3f51d911d280f.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-19</div><div class="title">每次起飞都是永别</div></div></a></div><div><a href="/2022/03/17/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%B8%85%E6%99%A8%E4%B8%80%E5%B0%8F%E6%97%B6%EF%BC%8C%E7%B4%AB%E4%B9%9D%E7%81%AB%E7%81%BE%E7%BA%AA%E5%AE%9E/" title="清晨一小时：紫荆公寓火情纪实"><img class="cover" src="https://pic.imgdb.cn/item/61ed143f2ab3f51d911d4294.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-17</div><div class="title">清晨一小时：紫荆公寓火情纪实</div></div></a></div><div><a href="/2022/03/17/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E4%BB%8E%E8%A1%A1%E6%B0%B4%E5%88%B0%E5%8C%97%E5%A4%A7%E9%99%84%E4%B8%AD%EF%BC%9A%E2%80%9C%E6%88%91%E5%8F%AF%E8%83%BD%E5%81%9A%E4%BA%86%E4%B8%AA%E9%94%99%E8%AF%AF%E7%9A%84%E5%86%B3%E5%AE%9A%E2%80%9D/" title="从衡水到北大附中：“我可能做了个错误的决定” & 和初恋结婚的概率，是1%"><img class="cover" src="https://pic.imgdb.cn/item/62270ee55baa1a80ab38d86d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-17</div><div class="title">从衡水到北大附中：“我可能做了个错误的决定” & 和初恋结婚的概率，是1%</div></div></a></div><div><a href="/2022/03/17/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%9C%80%E5%A5%BD%E7%9A%84%E4%B8%AD%E5%AD%A6%EF%BC%8C%E6%9C%80%E5%90%8E%E7%9A%84%E6%94%B9%E9%9D%A9/" title="最好的学校，最后的改革"><img class="cover" src="https://pic.imgdb.cn/item/61f0fc722ab3f51d91730c62.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-17</div><div class="title">最好的学校，最后的改革</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend.jpg'" alt="avatar"/></div><div class="author-info__name">zhaochen20</div><div class="author-info__description">华清大学计算机技术系在读</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">131</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zhaochenyang20"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">間違いだとしても　疑ったりしない　正しさとは　自分のこと　強く信じることだ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#philosophy"><span class="toc-number">1.</span> <span class="toc-text">Philosophy</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#a-clear-layout"><span class="toc-number">1.1.</span> <span class="toc-text">A clear layout</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#avoiding-unnecessary-commands"><span class="toc-number">1.2.</span> <span class="toc-text">avoiding unnecessary commands</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#a-first-script"><span class="toc-number">2.</span> <span class="toc-text">A First Script</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#variables---part-i"><span class="toc-number">3.</span> <span class="toc-text">Variables - Part I</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#scope-of-variables"><span class="toc-number">3.1.</span> <span class="toc-text">Scope of Variables</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#wildcards"><span class="toc-number">4.</span> <span class="toc-text">Wildcards</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#escape-characters"><span class="toc-number">5.</span> <span class="toc-text">Escape Characters</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#loops"><span class="toc-number">6.</span> <span class="toc-text">Loops</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#for-loops"><span class="toc-number">6.1.</span> <span class="toc-text">For Loops</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#while-loops"><span class="toc-number">6.2.</span> <span class="toc-text">While Loops</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#test"><span class="toc-number">7.</span> <span class="toc-text">Test</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#summary-of-special-symbols"><span class="toc-number">8.</span> <span class="toc-text">Summary of special symbols</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#case"><span class="toc-number">9.</span> <span class="toc-text">Case</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#variables---part-ii"><span class="toc-number">10.</span> <span class="toc-text">Variables - Part II</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/19/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/Euphoria/" title="亢奋 Euphoria丨青春疼痛，永远正在进行时"><img src="https://pic.imgdb.cn/item/6234f8855baa1a80ab09d3b9.jpg" onerror="this.onerror=null;this.src='https://wkphoto.cdn.bcebos.com/1f178a82b9014a9058a735deb9773912b31bee3c.jpg'" alt="亢奋 Euphoria丨青春疼痛，永远正在进行时"/></a><div class="content"><a class="title" href="/2022/03/19/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/Euphoria/" title="亢奋 Euphoria丨青春疼痛，永远正在进行时">亢奋 Euphoria丨青春疼痛，永远正在进行时</a><time datetime="2022-03-18T21:16:26.078Z" title="发表于 2022-03-19 05:16:26">2022-03-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/19/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%AF%8F%E6%AC%A1%E8%B5%B7%E9%A3%9E%E9%83%BD%E6%98%AF%E6%B0%B8%E5%88%AB/" title="每次起飞都是永别"><img src="https://pic.imgdb.cn/item/61ed14292ab3f51d911d280f.jpg" onerror="this.onerror=null;this.src='https://wkphoto.cdn.bcebos.com/1f178a82b9014a9058a735deb9773912b31bee3c.jpg'" alt="每次起飞都是永别"/></a><div class="content"><a class="title" href="/2022/03/19/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%AF%8F%E6%AC%A1%E8%B5%B7%E9%A3%9E%E9%83%BD%E6%98%AF%E6%B0%B8%E5%88%AB/" title="每次起飞都是永别">每次起飞都是永别</a><time datetime="2022-03-18T21:13:44.264Z" title="发表于 2022-03-19 05:13:44">2022-03-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/17/CS/%E5%85%B6%E4%BB%96/shell_script/" title="Shell Tutorial"><img src="https://pic.imgdb.cn/item/61eccc4f2ab3f51d91d6fcba.jpg" onerror="this.onerror=null;this.src='https://wkphoto.cdn.bcebos.com/1f178a82b9014a9058a735deb9773912b31bee3c.jpg'" alt="Shell Tutorial"/></a><div class="content"><a class="title" href="/2022/03/17/CS/%E5%85%B6%E4%BB%96/shell_script/" title="Shell Tutorial">Shell Tutorial</a><time datetime="2022-03-17T01:00:37.686Z" title="发表于 2022-03-17 09:00:37">2022-03-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/17/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%B8%85%E6%99%A8%E4%B8%80%E5%B0%8F%E6%97%B6%EF%BC%8C%E7%B4%AB%E4%B9%9D%E7%81%AB%E7%81%BE%E7%BA%AA%E5%AE%9E/" title="清晨一小时：紫荆公寓火情纪实"><img src="https://pic.imgdb.cn/item/61ed143f2ab3f51d911d4294.jpg" onerror="this.onerror=null;this.src='https://wkphoto.cdn.bcebos.com/1f178a82b9014a9058a735deb9773912b31bee3c.jpg'" alt="清晨一小时：紫荆公寓火情纪实"/></a><div class="content"><a class="title" href="/2022/03/17/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E6%B8%85%E6%99%A8%E4%B8%80%E5%B0%8F%E6%97%B6%EF%BC%8C%E7%B4%AB%E4%B9%9D%E7%81%AB%E7%81%BE%E7%BA%AA%E5%AE%9E/" title="清晨一小时：紫荆公寓火情纪实">清晨一小时：紫荆公寓火情纪实</a><time datetime="2022-03-16T21:36:17.152Z" title="发表于 2022-03-17 05:36:17">2022-03-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/17/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E4%BB%8E%E8%A1%A1%E6%B0%B4%E5%88%B0%E5%8C%97%E5%A4%A7%E9%99%84%E4%B8%AD%EF%BC%9A%E2%80%9C%E6%88%91%E5%8F%AF%E8%83%BD%E5%81%9A%E4%BA%86%E4%B8%AA%E9%94%99%E8%AF%AF%E7%9A%84%E5%86%B3%E5%AE%9A%E2%80%9D/" title="从衡水到北大附中：“我可能做了个错误的决定” &amp; 和初恋结婚的概率，是1%"><img src="https://pic.imgdb.cn/item/62270ee55baa1a80ab38d86d.jpg" onerror="this.onerror=null;this.src='https://wkphoto.cdn.bcebos.com/1f178a82b9014a9058a735deb9773912b31bee3c.jpg'" alt="从衡水到北大附中：“我可能做了个错误的决定” &amp; 和初恋结婚的概率，是1%"/></a><div class="content"><a class="title" href="/2022/03/17/%E9%9A%8F%E7%AC%94/%E5%8D%9A%E6%96%87/%E4%BB%8E%E8%A1%A1%E6%B0%B4%E5%88%B0%E5%8C%97%E5%A4%A7%E9%99%84%E4%B8%AD%EF%BC%9A%E2%80%9C%E6%88%91%E5%8F%AF%E8%83%BD%E5%81%9A%E4%BA%86%E4%B8%AA%E9%94%99%E8%AF%AF%E7%9A%84%E5%86%B3%E5%AE%9A%E2%80%9D/" title="从衡水到北大附中：“我可能做了个错误的决定” &amp; 和初恋结婚的概率，是1%">从衡水到北大附中：“我可能做了个错误的决定” &amp; 和初恋结婚的概率，是1%</a><time datetime="2022-03-16T21:32:06.829Z" title="发表于 2022-03-17 05:32:06">2022-03-17</time></div></div></div></div></div></div></main><footer id="footer" style="background: ＃191970"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By zhaochen20</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库正在艰难运行</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body></html>